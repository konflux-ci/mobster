
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Mobster is a tool for managing Software Bill of Materials (SBOMs)">
      
      
      
      
        <link rel="prev" href="../download/">
      
      
        <link rel="next" href="../oci_index_sbom/">
      
      
        
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.0">
    
    
      
        <title>OCI image - Mobster - SBOM management tool</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.618322db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#generate-oci-image" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Mobster - SBOM management tool" class="md-header__button md-logo" aria-label="Mobster - SBOM management tool" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Mobster - SBOM management tool
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              OCI image
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/Konflux-ci/mobster" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    mobster
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Overview

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../sbom_lifecycle/" class="md-tabs__link">
          
  
  
  SBOM lifecyle

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="./" class="md-tabs__link">
          
  
  
  SBOM content types

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../formats/" class="md-tabs__link">
        
  
  
    
  
  SBOM formats

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../development-environment/" class="md-tabs__link">
          
  
  
  Admin & developer guides

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Mobster - SBOM management tool" class="md-nav__button md-logo" aria-label="Mobster - SBOM management tool" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Mobster - SBOM management tool
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Konflux-ci/mobster" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    mobster
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    SBOM lifecyle
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    SBOM lifecyle
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sbom_lifecycle/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lifecycle
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../oci_image_augmentation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Augmentation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../upload/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Upload
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../download/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Download
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    SBOM content types
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    SBOM content types
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    OCI image
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    OCI image
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#architecture" class="md-nav__link">
    <span class="md-ellipsis">
      
        Architecture
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usage" class="md-nav__link">
    <span class="md-ellipsis">
      
        Usage
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#list-of-arguments" class="md-nav__link">
    <span class="md-ellipsis">
      
        List of arguments
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#generating-a-non-hermetic-sbom-from-scratch" class="md-nav__link">
    <span class="md-ellipsis">
      
        Generating a (non-hermetic) SBOM from scratch
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#contextual-sbom" class="md-nav__link">
    <span class="md-ellipsis">
      
        Contextual SBOM
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#requirements-for-executing-contextual-sbom-workflow" class="md-nav__link">
    <span class="md-ellipsis">
      
        Requirements for executing Contextual SBOM workflow
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#functional-breakdown" class="md-nav__link">
    <span class="md-ellipsis">
      
        Functional breakdown
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Functional breakdown">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#contextual-sbom-for-non-hermetic-build" class="md-nav__link">
    <span class="md-ellipsis">
      
        Contextual SBOM for non-hermetic build
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#builder-content-contextualization" class="md-nav__link">
    <span class="md-ellipsis">
      
        Builder content contextualization
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#contextual-sbom-for-hermetic-build" class="md-nav__link">
    <span class="md-ellipsis">
      
        Contextual SBOM for hermetic build
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../oci_index_sbom/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    OCI index image
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../oci_artifact/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    OCI artifact
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../modelcar_sbom/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Modelcar
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../product/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Product
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../formats/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    SBOM formats
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Admin & developer guides
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Admin & developer guides
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development-environment/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Development environment
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../integration-testing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Integration testing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../release/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Release
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="generate-oci-image">Generate OCI Image</h1>
<p>This utility allows users to generate SBOMs related to Container Images.</p>
<h2 id="architecture">Architecture</h2>
<p>The scripts accepts any number of SBOMs generated by SYFT and at most one SBOM
generated by Hermeto (previously known as Cachi2), with the requirement that
at least one SBOM is provided in total. It combines these SBOMs
and takes them as a context of the built image.</p>
<p>The script also parses a JSON-ified Dockerfile of the image, parses its
content and determines which base images were used to build the image.
It identifies builder images as well as a <em>parent image</em> which is the
latest image in the Dockerfile (or the base image for the stage identified
by the build target).</p>
<p>Additionally, you can also supply additional builder images on top of those
already parsed from the Dockerfile.</p>
<p>All provided SBOMs must be in the same specification! This script does not
support combining SPDX and CycloneDX SBOMs.</p>
<h2 id="usage">Usage</h2>
<pre><code class="language-bash">mobster --verbose  generate oci-image \
--from-syft tests/sbom/test_merge_data/cyclonedx/syft-sboms/pip-e2e-test.bom.json \
--from-syft tests/sbom/test_merge_data/cyclonedx/syft-sboms/ubi-micro.bom.json \
--from-hermeto tests/sbom/test_merge_data/cyclonedx/cachi2.bom.json \
--image-pullspec quay.io/foobar/examplecontainer:v10 \
--image-digest sha256:1 \
--parsed-dockerfile-path tests/data/dockerfiles/somewhat_believable_sample/parsed.json \
--dockerfile-target build \
--additional-base-image quay.io/ubi9:latest@sha256:123456789012345678901234567789012
</code></pre>
<h2 id="list-of-arguments">List of arguments</h2>
<ul>
<li><code>--from-syft</code> -- points to an SBOM file (in a JSON format) created by Syft, can be used multiple times</li>
<li><code>--from-hermeto</code> -- points to an SBOM file (in a JSON format) created by Hermeto</li>
<li><code>--image-pullspec</code> -- the pullspec of the image processed in the format <code>&lt;registry&gt;/&lt;repository&gt;:&lt;tag&gt;</code></li>
<li><code>--image-digest</code> -- the digest of the image processed in the format <code>sha256:&lt;digest value&gt;</code></li>
<li><code>--parsed-dockerfile-path</code> -- points to a dockerfile processed by <code>dockerfile-json</code></li>
<li><code>--base-image-digest-file</code> -- points to a file with digests for images used in Dockerfile.
  if omitted, the references will be fetched via <code>oras</code>. The expected format of the file is
  <code>&lt;registry&gt;/&lt;repository&gt;:&lt;tag&gt; &lt;registry&gt;/&lt;repository&gt;:&lt;tag&gt;@sha256:&lt;digest&gt;</code></li>
<li><code>--dockerfile-target</code> -- if a build target was used for multi-stage build, use this argument to specify the build target</li>
<li><code>--additional-base-images</code> -- optionally add references to other build images outside the parsed Dockerfile.
  expects the format <code>&lt;registry&gt;/&lt;repository&gt;:&lt;tag&gt;@sha256:&lt;digest value&gt;</code></li>
<li><code>--contextualize</code> -- Allows SBOM contextualization (see <a href="#contextual-sbom">Contextual SBOM</a>)</li>
<li><code>--output</code> -- where to save the SBOM. prints it to STDOUT if this is not specified</li>
<li><code>--skip-validation</code> -- skips validation of the SBOM</li>
</ul>
<h2 id="generating-a-non-hermetic-sbom-from-scratch">Generating a (non-hermetic) SBOM from scratch</h2>
<p>To build an SBOM with only the OCI image, you will need to run several tools to
get prerequisite files to use in the <code>mobster generate</code> command. These two tools are:</p>
<ul>
<li>Syft (https://github.com/anchore/syft): for initial scanning and SBOM generation</li>
<li>dockerfile-json (https://github.com/keilerkonzept/dockerfile-json): for
  generating a human-readable Dockerfile/Containerfile manifest</li>
</ul>
<p>Download and install them before this process.</p>
<p>Assuming you have the Containerfile, and the OCI image stored in a repository
(or your localhost), the process is as follows:</p>
<ol>
<li>Use Syft to generate the intermediate SBOM to use in <code>--from-syft</code>, in SPDX format:</li>
</ol>
<pre><code class="language-sh">syft scan quay.io/konflux-ci/mobster:latest --output spdx-json &gt; syft.json
</code></pre>
<ol>
<li>Use dockerfile-json to generate a machine-readable Dockerfile/Containerfile
   description for the tool to use:</li>
</ol>
<pre><code class="language-sh">dockerfile-json ./Containerfile &gt; containerfile.json
</code></pre>
<ol>
<li>Run <code>mobster generate</code> with the prerequisite files and the same OCI image
   URL you used in the previous steps (note the argument order, <code>--output</code>
   should come before <code>oci-image</code>):</li>
</ol>
<pre><code class="language-sh">mobster generate \
    --output full-sbom.json \
    oci-image \
    --from-syft syft.json \
    --parsed-dockerfile-path containerfile.json \
    --image-pullspec quay.io/konflux-ci/mobster:latest
</code></pre>
<p>Once the command is complete, you should see the full Mobster SBOM in
<code>full-sbom.json</code> in your working directory.</p>
<h2 id="contextual-sbom">Contextual SBOM</h2>
<p>Contextual SBOM is a feature that establishes relationships between container images and their parent
(base) or builder images in the software supply chain. Instead of treating each
image as isolated, it creates a hierarchical view showing how packages flow from
parent or builder images to child images. Knowing the origin of the content establishes a
foundation for targeted content and vulnerability tracking within the image hierarchy.</p>
<p>This documentation is intended for anyone interested in contextual SBOM or directly using it.
It aims to set clear expectations about the feature by defining the requirements for obtaining it,
explaining how it is assembled and structured, outlining potential future changes, and describing
its benefits and limitations.</p>
<ul>
<li>Feature will be released gradually. Planned features:<ul>
<li>✅ <strong>Contextual SBOM for non-hermetic build</strong><ul>
<li>identification of the base image content in component in non-hermetic build</li>
<li>achieved by matching packages from the base image SBOM to the component
  SBOM and marking their origin with relationships</li>
</ul>
</li>
<li>⏳ <strong>Builder content contextualization</strong><ul>
<li>identification of the content copied from multistage build stages to component</li>
<li>acquired by generating an SBOM from content copied from builder images
  and merged into the final SBOM to indicate the origin of that content</li>
</ul>
</li>
<li>⏳ <strong>Contextual SBOM for hermetic build</strong><ul>
<li>differentiation of the base image content and component content in hermetic build</li>
<li>assembled from base image content, hermeto content and - in multistage builds -
  builder content</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="requirements-for-executing-contextual-sbom-workflow">Requirements for executing Contextual SBOM workflow</h2>
<ul>
<li>Base image of the component must be built by konflux and must have SBOM attached</li>
<li>Attached base image SBOM must be in SPDX format with version 2.X.</li>
<li><code>--contextualize</code> flag is present</li>
</ul>
<p>If requirements are not fulfilled, non-contextual SBOM will be produced.</p>
<h2 id="functional-breakdown">Functional breakdown</h2>
<ul>
<li>Feature profoundly changes relationship structure of the SBOM<ul>
<li><strong>Non-contextual SBOM:</strong> Relationships capture only first base image as component ancestor.
  All package relationships point to component. There is no concept of the base/parent
  image content, origin of the packages is unknown. Those are all SBOMs produced before
  contextualization.</li>
<li><strong>Contextual SBOM:</strong> Relationships capture all base images as component ancestors in
  ordered chain up to last non-contextualized ancestor. Package relationships point
  to those ancestors (or component itself) indicating origin of the package.</li>
</ul>
</li>
<li>Mechanism of Contextual SBOM is different for the hermetic and non-hermetic build.</li>
<li>Comparing to non-contextual SBOM, <strong>all packages remain present</strong>; none are removed.</li>
<li>Gradual changes will remain <strong>backward compatible</strong> and will build on each other,
  resulting in a richer and more accurate SBOM (e.g., base image content identification
  in non-hermetic builds will later be enhanced with builder content for components with
  multistage builds, forming the foundation for contextual SBOMs in hermetic builds).</li>
<li>Contextual SBOMs are designed to be <strong>self-assembling</strong> and this works across hermetic and
  non-hermetic builds interchangeably and also with contextualized or non-contextualized
  parent SBOMs. 
  It means that built component can be contextualized by its parent SBOM regardless if parent
  SBOM is sourced from hermetic or non-hermetic build, or if it is contextualized or
  non-contextualized. It also means that if parent SBOM is contextualized (is aware of its 
  parent - or component's grandparent content), contextual information is preserved and
  passed to the component.</li>
<li>Contextual SBOM mechanism can be disabled by <em>not</em> including <code>--contextualize</code> flag in
  <code>mobster generate oci-image</code> command - in that case, non-contextual SBOM will be produced.</li>
</ul>
<h3 id="contextual-sbom-for-non-hermetic-build">Contextual SBOM for non-hermetic build</h3>
<p>Contextual SBOM for non-hermetic build is achieved by generating syft-based component SBOM,
downloading a SBOM of the base image (if exists and has SPDX format) and matching packages
from parent to component according to the chosen identifiers.
<code>CONTAINS</code> relationships of the matched packages are modified in component SBOM indicating
source of origin shifting relationships from component to parent or grandparents.</p>
<p><em>Warning:</em> Matching mechanism is not perfect, because SPDX specification is missing
consistent unique identifier across different packages and thus Contextual SBOM for
non-hermetic build is for now the best effort considering differentiation between content
added by component and its parent content. This means that not all content from parent
can be identified in component. This might be improved in future versions.
For now for every such Contextual SBOM document produced in non-hermetic build one can say:
- this portion of the identified packages is sourced from parent (or grandparents)
  of the component
- packages that were not matched could be sourced either from parent (or
  grandparents) or they were installed in component (in fact, this is current
  state in non-contextual SBOM)</p>
<h3 id="builder-content-contextualization">Builder content contextualization</h3>
<p>Builder content is any content copied from builder images in multistage builds. This content
will be identified by inspection of build layers in local buildah build artifacts storage.
From this content, an SPDX SBOM is generated. The relationships will describe the origin of
copied content from specific builder images, and this partial SBOM is subsequently merged
into the final Contextual SBOM. This content;
- will be produced only within contextual SBOM workflow for components with
  multistage build
- will be deduplicated against Contextual SBOM from non-hermetic build (builder packages
  should be already captured in syft component scan)
- will serve as last step for Contextual SBOM for hermetic build enablement</p>
<h3 id="contextual-sbom-for-hermetic-build">Contextual SBOM for hermetic build</h3>
<p>Contextual SBOM for hermetic build is not produced by matching of the packages between two
SPDX documents but assembled from two (single-stage builds) or three (multi-stage builds)
SBOMs:
1. Downloaded parent content (if not available, contextual SBOM is skipped and non-contextual 
   SBOM will be produced) defines the content of the base image. Might be previously
   contextualized or not.
2. Hermeto content is representation of content installed in component on the top of base
   image (not including builder content - hermeto cannot see it)
3. [In case of multistage builds] - Builder content defines the content copied from multistage
   build stages to the component.</p>
<p>Assembling SBOM this way is reducing dependence on syft - no syft scan has to be performed on
built component, no deduplication is done with hermeto SBOM afterward. Another benefit of hermetic
build contextual SBOMs is, the more ancestors of a component are built hermetically, the less
Syft-detected content will appear in the component’s SBOM.
Warning: It is important to understand that a downloaded parent SBOM content may be affected by
the component’s build process (some packages may be removed during build, for example <code>dnf update
package</code> will update <code>package</code> but also may remove other packages by resolving dependency tree).
This could occasionally result false positives in the resulting SBOM sourced from parent content.</p>
<h1 id="structure-of-the-generated-sbom-non-contextual-sbom">Structure of the generated SBOM (non-contextual SBOM)</h1>
<p>The generated SBOM has following structure:</p>
<pre><code> - SPDXRef-DOCUMENT
    - SPDXRef-image (DESCRIBES)
        - package A (CONTAINS)
        - package B (CONTAINS)
        - package C (CONTAINS)
        - base image (DESCENDANT_OF)
        - builder image 1 (BUILD_TOOL_OF)
        - builder image 2 (BUILD_TOOL_OF)
</code></pre>
<h1 id="structure-of-the-generated-sbom-contextual-sbom">Structure of the generated SBOM (Contextual SBOM)</h1>
<p>The generated SBOM has following structure:</p>
<pre><code> - SPDXRef-DOCUMENT
    - SPDXRef-image (DESCRIBES)
        - package A (CONTAINS)
        - package B (CONTAINS)
        - base image (DESCENDANT_OF)
            - package C (CONTAINS)
            - grandparent image (DESCENDANT_OF)
                - package D (CONTAINS)
        - builder image 1 (BUILD_TOOL_OF)
        - builder image 2 (BUILD_TOOL_OF)
</code></pre>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["navigation.tabs", "navigation.sections", "navigation.expand", "toc.integrate"], "search": "../../assets/javascripts/workers/search.7a47a382.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.e71a0d61.min.js"></script>
      
    
  </body>
</html>